<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SaturnX - Ptero Installer</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;500&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Fira Code', monospace; background-color: #0d1117; }
        .glass { background: rgba(22, 27, 34, 0.8); backdrop-filter: blur(10px); border: 1px solid rgba(56, 189, 248, 0.2); }
    </style>
</head>
<body class="text-gray-300 min-h-screen p-4 md:p-10">
    <div class="max-w-4xl mx-auto">
        <header class="text-center mb-10">
            <h1 class="text-4xl font-bold text-sky-400 mb-2">SATURNX INSTALLER</h1>
            <p class="text-gray-500">Automated Pterodactyl Deployment System</p>
        </header>

        <div class="glass rounded-xl p-6 shadow-2xl">
            <div class="flex space-x-4 mb-8 border-b border-gray-700 pb-4">
                <button onclick="switchTab('install')" class="tab-btn text-sky-400 border-b-2 border-sky-400 pb-2">INSTALL PANEL</button>
                <button onclick="switchTab('wings')" class="tab-btn hover:text-sky-400 pb-2">WINGS ONLY</button>
                <button onclick="switchTab('uninstall')" class="tab-btn hover:text-sky-400 pb-2 text-red-400">UNINSTALL</button>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                    <label class="block text-xs text-sky-500 uppercase mb-2">Access Key (Premium)</label>
                    <input type="password" id="accessKey" placeholder="Masukkan Key Admin" class="w-full bg-gray-900 border border-gray-700 rounded p-3 focus:outline-none focus:border-sky-500 transition">
                </div>
                <div>
                    <label class="block text-xs text-sky-500 uppercase mb-2">IP VPS</label>
                    <input type="text" id="ip" placeholder="1.1.1.1" class="w-full bg-gray-900 border border-gray-700 rounded p-3 focus:outline-none focus:border-sky-500 transition">
                </div>
                <div>
                    <label class="block text-xs text-sky-500 uppercase mb-2">Password VPS (Root)</label>
                    <input type="password" id="pw" placeholder="******" class="w-full bg-gray-900 border border-gray-700 rounded p-3 focus:outline-none focus:border-sky-500 transition">
                </div>
                
                <div id="extra-fields" class="md:col-span-2 grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label class="block text-xs text-sky-500 uppercase mb-2">Domain Panel</label>
                        <input type="text" id="domPnl" placeholder="pnl.domain.com" class="w-full bg-gray-900 border border-gray-700 rounded p-3">
                    </div>
                    <div>
                        <label class="block text-xs text-sky-500 uppercase mb-2">Domain Node</label>
                        <input type="text" id="domNode" placeholder="node.domain.com" class="w-full bg-gray-900 border border-gray-700 rounded p-3">
                    </div>
                    <div>
                        <label class="block text-xs text-sky-500 uppercase mb-2">RAM (MB)</label>
                        <input type="number" id="ram" placeholder="8000" class="w-full bg-gray-900 border border-gray-700 rounded p-3">
                    </div>
                </div>
            </div>

            <button onclick="process()" id="submitBtn" class="w-full mt-8 bg-sky-600 hover:bg-sky-500 text-white font-bold py-4 rounded-lg shadow-lg shadow-sky-900/20 transition duration-300">
                EXECUTE PROCESS
            </button>
        </div>

        <div id="terminal" class="mt-10 glass rounded-lg p-4 h-64 overflow-y-auto text-sm font-mono border-l-4 border-sky-500">
            <p class="text-sky-500">System Ready. Awaiting command...</p>
        </div>
    </div>

    <script>
        let currentTab = 'install';

        function switchTab(tab) {
            currentTab = tab;
            const extraFields = document.getElementById('extra-fields');
            const submitBtn = document.getElementById('submitBtn');
            
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('text-sky-400', 'border-b-2', 'border-sky-400'));
            event.target.classList.add('text-sky-400', 'border-b-2', 'border-sky-400');

            if (tab === 'install') {
                extraFields.innerHTML = `
                    <div><label class="block text-xs text-sky-500 uppercase mb-2">Domain Panel</label><input type="text" id="domPnl" class="w-full bg-gray-900 border border-gray-700 rounded p-3"></div>
                    <div><label class="block text-xs text-sky-500 uppercase mb-2">Domain Node</label><input type="text" id="domNode" class="w-full bg-gray-900 border border-gray-700 rounded p-3"></div>
                    <div><label class="block text-xs text-sky-500 uppercase mb-2">RAM (MB)</label><input type="number" id="ram" class="w-full bg-gray-900 border border-gray-700 rounded p-3"></div>
                `;
                submitBtn.className = "w-full mt-8 bg-sky-600 hover:bg-sky-500 text-white font-bold py-4 rounded-lg";
            } else if (tab === 'wings') {
                extraFields.innerHTML = `
                    <div class="md:col-span-2"><label class="block text-xs text-sky-500 uppercase mb-2">Token Wings</label><input type="text" id="token" placeholder="Masukkan Token dari Panel" class="w-full bg-gray-900 border border-gray-700 rounded p-3"></div>
                `;
            } else {
                extraFields.innerHTML = `<p class="md:col-span-2 text-red-400 text-center py-4 italic">Peringatan: Seluruh data pterodactyl akan dihapus permanen.</p>`;
                submitBtn.className = "w-full mt-8 bg-red-600 hover:bg-red-500 text-white font-bold py-4 rounded-lg";
            }
        }

        async function process() {
            const log = (msg, color = 'text-gray-400') => {
                const p = document.createElement('p');
                p.className = color;
                p.innerText = `> ${msg}`;
                document.getElementById('terminal').appendChild(p);
                document.getElementById('terminal').scrollTop = document.getElementById('terminal').scrollHeight;
            };

            const data = {
                key: document.getElementById('accessKey').value,
                ip: document.getElementById('ip').value,
                pw: document.getElementById('pw').value,
                domPnl: document.getElementById('domPnl')?.value,
                domNode: document.getElementById('domNode')?.value,
                ram: document.getElementById('ram')?.value,
                token: document.getElementById('token')?.value
            };

            if (!data.key || !data.ip || !data.pw) return alert("Lengkapi data utama wok!");

            log(`Menghubungkan ke ${data.ip}...`, 'text-yellow-500');
            
            try {
                const res = await fetch(`/api/${currentTab}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                });
                const result = await res.json();
                
                if (result.success) {
                    log(result.message, 'text-green-400');
                } else {
                    log(`Error: ${result.message}`, 'text-red-500');
                }
            } catch (e) {
                log("Gagal menghubungi API Backend.", "text-red-500");
            }
        }
    </script>
</body>
</html>
